var regex = /[.;:]/;
var text_array = RiTa.splitSentences("Basically, it’s like this: When I was fourteen and living in China, I found Haruki Murakami’s memoir, What I Talk About When I Talk About Running at my high school library. I had never read any of Murakami’s fiction (and still haven’t), and wasn’t particularly interested in him or his work, but the name was obviously familiar. But the spine was yellow and pristine, so I pulled the book off the shelf. I skimmed through it, and the direct, unpretentious prose appealed to me so I took it home. At face value, Murakami’s memoir should be somewhat irrelevant to a fourteen-year-old. Murakami was around fifty when he wrote it, and it would probably appeal more to someone undergoing a mid-life crisis. But there was something about the writing’s unassuming nature that felt vaguely inspirational to me. On the most basic level, at least, it did inspire me to regularly go on runs for two years, until I went to college. For that summer after tenth grade, I would run almost every day along a path that wound up and around a nearby hill called 东山风景区 (east mountain scenic area). The whole park/tourist attraction/green space complex has two defining landmarks: 1) a giant bronze statue of a baby riding a bull with wings, and 2) a giant metal and glass structure shaped like a UFO on stilts, that people were able to walk into but served no real purpose (Observatory? For what though?). That uniquely Chinese surface-level posturing of grandness is, in my mind, perfectly embodied in the glint of sunlight reflecting off of the grotesquely large bronze statue. It is one of the images of my adolescence I will never forget. I would run after dinner, basking in the glow of the smog-enhanced sunset. The late afternoon sun seemed to fight to stay above the horizon, and I repeated mantras to myself because that is one of the things Murakami does when he runs. “Pain is inevitable. Suffering is optional,” he writes, is what he would repeat to himself over and over. So I did the same. I would come home in the dim blue light between the sun setting and night actually falling, coated evenly with a slick sheen of sweat. I felt happy and satisfied even though I recognized the feeling as a temporary state due to the endorphins I had just released. The other thing about me when I was 14 is that there was an extended period of time during high school when I just wouldn’t eat. I’m really only just starting to piece together why that was, because this is a problem that I sort of just got over and never thought about again. I would struggle to eat breakfast, having to wash down every bite of food with big gulps of water. I often skipped lunch at school, and then I would pick at my dinner and only end up eating a couple bites. I just simply had no appetite. My parents, I suspect, probably thought I had an eating disorder. I was developing theories that I had a tapeworm living inside of me. Now, looking back, I think I was simply depressed. I was a weak, asthmatic child, and I’ve had heart surgery, as well as a slew of ear surgeries that frequently took me out of school for weeks at a time. I also figured out I was gay when I was maybe nine years old and had been hiding it ever since, so maybe that was part of it too. So as a result of being weak and gay, I had a very low self image of my body and what I was supposed to do with it. But I still have very fond memories of the summers during high school. Running was a way for me to reclaim my body. It was the first time that I felt even remotely comfortable with the flesh I inhabited. I was always really bad at anything athletic, but running was something that required very little skill. It was the only physical thing that I was ever really good at. Maybe it was the endorphins, or all the additional vitamin D, but I was definitely a lot happier during the summer. The sky was always beautiful. I didn’t mind being alone.  So today, July 2nd, 2018, is the day before my twentieth birthday. Meaning it is officially the last day of my teenage years. As I am browsing through a bookstore, I find Murakami’s memoir again. I carried it with me as I meandered through the rest of the store, and ended up buying it. This book is possibly the only piece of media I’ve ever consumed that has actually inspired me to change my life for the better, so my thought was that maybe re-reading it now will spark some of that magic of self-actualization again. Another thing is that a couple days ago, I had dinner with my older sister. We started getting annoyed with each other, arguing about who had the harder childhood or something equally as pointless. She said something like, “you don’t know what my experience was”, and I said something like, “well, you don’t know what my experience was.” She paused for a second, and then asked me if I was ever going to tell our parents that I was gay. I said no, and she asked why not. Because I can't, I thought, but for some reason this was extremely hard to verbalize. Instead, I said, I'm gonna go, and stood up abruptly and left. As I walked away I immediately felt my mouth contort and my eyes push out hot tears. I couldn’t suppress it. The moment felt ridiculous to me. Here I am, I thought. Crying in the streets of New York. I tried to hide my face from the people walking past me. By the time I reached the subway station a block away, I was crying uncontrollably. I thought about what I could do at that moment to save face. I could try to calm myself down and go home, but I really didn't want to start crying again on a crowded train. The only thing worse than crying at a subway station is crying on the subway. So instead I call my sister, and she meets me outside, and we walk to a nearby park. I tell her, somewhat incoherently, that I hate being gay. Well, not exactly that, but I hate the combination of being gay and also Chinese. I think that if I was white, I would enjoy being gay. It's a heartbreaking statement. Of course I know that I shouldn't feel this way, and I don't want to, but that doesn't change the fact that the feeling is still within me. I don’t know, I’m working on it. I'm not sure if I'm ready to put into words what else was said and what else was revealed, but it felt like the repression of the last literal decade of not being able to talk to my parents about anything regarding love or sex or intimacy, and the repression of always trying to seem a little less feminine, has finally started to crack. It was the first time I had had a real cry in the past three years. I had forgotten what it felt like. I had forgotten what it felt like to be unable to stop. My friends always talk about crying, and crying frequently, so I say that I cry frequently as well, but what I really mean is that I can maybe muster one or two tears out in the dark of a movie theater and that's about it. So I’ve been a bit emotionally raw for the past week. I'm turning twenty, and I'm in need of inspiration, or motivation, or something to spark change. That's why I bought Murakami's memoir again. Maybe I'll start running again. Maybe I’ll just start washing my face consistently. Murakami writes that any task, done with enough repetition and consistency, becomes a contemplative act. Murakami writes that he likes being alone. I want to like being alone. I want all my acts to be contemplative ones. On July 3rd, my birthday, my first day after two decades, as I walked to work, I made the following note: You make yourself known in public spaces in a way I would never dare to I feel no impetus to talk to any stranger ever, never any impetus to forge random connections, to ask how anyone's day was, to me the burden of human connection is assumed, so, not wanting to ever be a burden, I dare not assume anyone would ever want to strike up a conversation with me. Total enjoyment zero inferred. And also, On the subway I see a hotter version of me. I try to make myself invisible and unassuming in public spaces. But I have a friend, whom I love very much, who makes himself seen and heard regardless of whether he is in public or private. He is unconcerned with the opinions of strangers. I will often turn away from him for a second, and then turn around to see that he has somehow struck up a conversation, an interaction, a connection, with some random stranger. When I began to notice this difference between him and I, I wondered, is this a white thing? To be able to talk to strangers so fluidly? To make the most of what the world has to offer? Is the patently asian-american/child-of-immigrants psychic crutch of alienation so strongly inherited within me? I often wonder if I should make some sort of effort to be more like him. But today Murakami reminds me that it is okay to be alone, and it is okay to want to be alone, and it is okay to like being alone. And I don’t think I feel lonely when I am alone. Murakami reminds me of the joy of contemplation, of intense introspection, through which my teenage-borne anxieties and traumas may rise to the surface and exorcise themselves as I enter my twenties. It’s a little weird to think about not being a teenager anymore. But I think I'm ready. Maybe I’ll go on a run tomorrow, as I feel the first sunset of the rest of my life glancing off my back.  The freedom of being alone is a valid one.");
var div_array = [];
var n = text_array.length;
for (let i = 0; i < n; i++){
  div_array = div_array.concat(document.createElement('div'));
}


var offset_x = 50;
var x_dir = 1;
var offset_y = 50;
$(document).ready(function() {
  for(let d of div_array){
    $(d).css("left", offset_x);
    $(d).css("top", offset_y);
    $(d).css("position", "absolute");
    $("body").append(d);
    if(offset_x >= $(window).width() - (100+$(d).width())){
      x_dir = -1;
    } else if(offset_x <= 50){
      x_dir = 1;
    }
    offset_x += 50*x_dir;
    offset_y += 50;
  }

  for(let i = 0; i < div_array.length; i++){
    $(div_array[i]).text(text_array[i]);
  }

  $("div").draggable({
    stack: "div",
    grid: [50, 50],
    // start: function(event, ui){
		// 	$(this).css("transition", "0s");
		// },
		// stop: function(event, ui){
		// 	$(this).css("transition", "0.25s");
		// }
  });

  $("div").click(function(){
    $(this).css('z-index', 2);
    $(this).siblings('div').css('z-index', 1);


  });

  var intervalID;
  $("div").hover(function(){
    var old_top = parseInt($(this).css('top'), 10);
    // var old_left = parseInt($(this).css('left'), 10);
    $(this).css('top', old_top-(Math.floor(Math.random()*10)+5));
    // $(this).css('left', old_left+Math.floor(Math.random()*2)-1);

    var ref = this;
    intervalID = setInterval(function(){
      new_string = changeString($(ref).text());
      $(ref).text(new_string);
    }, (Math.floor(Math.random()*5000 + 5000)));

  }, function(){
    var old_top = parseInt($(this).css('top'), 10);
    // var old_left = parseInt($(this).css('left'), 10);
    $(this).css('top', old_top+(Math.floor(Math.random()*10)+5));
    // $(this).css('left', old_left-Math.floor(Math.random()*2)-1);
    // clearInterval(intervalID);
  });


  $(window).on('resize', function(){
    offset_x = 50;
    x_dir = 1;
    offset_y = 50;
    console.log("resize");
    for(let d of div_array){
      $(d).css("left", offset_x);
      $(d).css("top", offset_y);
      if(offset_x > $(window).width() - (150+$(d).width())){
        x_dir = -1;
      } else if(offset_x <= 50){
        x_dir = 1;
      }
      offset_x += 50*x_dir;
      offset_y += 50;
    }
  });

});



function changeString(string){
  var words = RiTa.tokenize(string);
  var rand = Math.floor(Math.random()*words.length);
  var tag = RiTa.getPosTags(words[rand]);
  var new_word = RiTa.randomWord(tag[0]);
  // console.log(new_word);
  words[rand] = new_word;
  return RiTa.untokenize(words);
}
